import csv

import random
import matplotlib.pyplot as plt
from matplotlib.pyplot import figure
import numpy as np

# Typing
import typing
from typing import TypeVar, Generic
from collections.abc import Callable

from tqdm import tqdm
from collections import namedtuple
import statistics
import dataclasses
from dataclasses import dataclass
from tensorflow.keras.optimizers import Adam
from tensorflow.keras import datasets, layers, models
import tensorflow as tf

from matplotlib.backends.backend_pdf import PdfPages

# cd Documents/
# cd populationDescent/
# python3 -m venv ~/venv-metal
# source ~/venv-metal/bin/activate
# python3 -m plotting_progress_FMNIST




## ESGD
ema_ESGD = [0.7147568140029907, 0.7147568140029907, 0.7063239600372315, 0.6904548344116211, 0.6737380081016541, 0.6529779560326385, 0.6312089610408707, 0.6110588607684639, 0.5913711296059967, 0.572636624606098, 0.5552297108408617, 0.5392673656436927, 0.5238285007548148, 0.5087118442230059, 0.4956699083101123, 0.48244700060707657, 0.46923594914217887, 0.45864946948713153, 0.44770697970890483, 0.4363916123006059, 0.4253704713428003, 0.4155497089222654, 0.4061756981702671, 0.3984000114117884, 0.38980988669826, 0.3817943898096688, 0.3738245924259729, 0.36680000767697457, 0.36022366800894945, 0.35444774962476444, 0.3475625654454072, 0.3411030203457212, 0.3351495013614478, 0.3299197999149545, 0.3247554833701239, 0.32005707379558557, 0.31582810273270795, 0.3117660646018474, 0.30849209666404925, 0.30568624790806, 0.3026341200616815, 0.29921485983135027, 0.2960857052815114, 0.2940475748803158, 0.29156016368859466, 0.28966137870544306, 0.2875035294758747, 0.28509831545479325, 0.28341998261088636, 0.2811936787081466, 0.2796161113505995, 0.27853373191643677, 0.2782309327044093, 0.276636747925103, 0.2746382516222778, 0.27277284675576535, 0.27078584412221535, 0.269158627746264, 0.2677651829413413, 0.26762456534729945, 0.26611578773999106, 0.2649905692608108, 0.26415705728807604, 0.26383652404080526, 0.26298465265688925, 0.26200204312316444, 0.261466875126766, 0.26094804889453066, 0.2600120017346079, 0.2588758463462891, 0.25870860681599694, 0.2582846699434488, 0.2589567838988872, 0.2585021208717381, 0.2577046227068265, 0.25628141042088504, 0.2563630747600946, 0.2564744426790971, 0.25531082490063595, 0.25657403019228775, 0.25644145208322283, 0.25716294991365024, 0.2566142325609113, 0.25601394599877464, 0.25603160533728603, 0.25647128072103026, 0.25580476763534693, 0.25641680803079736, 0.255119834597522, 0.2555565920921689, 0.25502196578614644, 0.2548081960526055, 0.25487950303735846, 0.2541135944382773]
x_ESGD = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500]
history_ESGD = [0.7147568140029907, 0.6304282743453979, 0.5476327037811279, 0.5232865713119507, 0.466137487411499, 0.4352880061149597, 0.429707958316803, 0.4141815491437912, 0.40402607960700987, 0.39856748695373534, 0.39560625886917117, 0.3848787167549133, 0.3726619354367256, 0.37829248509407043, 0.36344083127975463, 0.35033648595809935, 0.3633711525917053, 0.3492245717048645, 0.3345533056259155, 0.32618020272254944, 0.3271628471374512, 0.3218096014022827, 0.3284188305854797, 0.3124987642765045, 0.3096549178123474, 0.30209641597270964, 0.30357874493598935, 0.3010366109967232, 0.302464484167099, 0.28559590783119204, 0.2829671144485474, 0.2815678305029869, 0.2828524868965149, 0.2782766344666481, 0.2777713876247406, 0.27776736316680906, 0.27520772142410277, 0.2790263852238655, 0.2804336091041565, 0.2751649694442749, 0.26844151775836944, 0.267923314332962, 0.2757044012695551, 0.26917346296310424, 0.27257231385707853, 0.2680828864097595, 0.2634513892650604, 0.2683149870157242, 0.26115694358348845, 0.26541800513267516, 0.26879231700897216, 0.27550573979616166, 0.26228908491134645, 0.2566517848968506, 0.2559842029571533, 0.2529028204202652, 0.2545136803627014, 0.25522417969703676, 0.26635900700092313, 0.2525367892742157, 0.25486360294818877, 0.25665544953346253, 0.26095172481536866, 0.2553178102016449, 0.2531585573196411, 0.25665036315917966, 0.25627861280441283, 0.25158757729530334, 0.24865044785141946, 0.2572034510433674, 0.25446923809051514, 0.26500580949783326, 0.2544101536273956, 0.25052713922262193, 0.24347249984741212, 0.2570980538129807, 0.25747675395011904, 0.24483826489448549, 0.2679428778171539, 0.2552482491016388, 0.2636564303874969, 0.251675776386261, 0.25061136693954467, 0.25619053938388825, 0.2604283591747284, 0.24980614986419677, 0.2619251715898514, 0.24344707369804383, 0.2594874095439911, 0.2502103290319443, 0.252884268450737, 0.255521265900135, 0.24722041704654693]


# seed 1
ema_ESGD15_s1 = [0.7147568140029907, 0.7147568140029907, 0.7063239600372315, 0.6904548344116211, 0.6737380081016541, 0.6529779560326385, 0.6312089610408707, 0.6110588607684639, 0.5913711296059967, 0.572636624606098, 0.5552297108408617, 0.5392673656436927, 0.5238285007548148, 0.5087118442230059, 0.4956699083101123, 0.48244700060707657, 0.46923594914217887, 0.45864946948713153, 0.44770697970890483, 0.4363916123006059, 0.4253704713428003, 0.4155497089222654, 0.4061756981702671, 0.3984000114117884, 0.38980988669826, 0.3817943898096688, 0.3738245924259729, 0.36680000767697457, 0.36022366800894945, 0.35444774962476444, 0.3475625654454072, 0.3411030203457212, 0.3351495013614478, 0.3299197999149545, 0.3247554833701239, 0.32005707379558557, 0.31582810273270795, 0.3117660646018474, 0.30849209666404925, 0.30568624790806, 0.3026341200616815, 0.29921485983135027, 0.2960857052815114, 0.2940475748803158, 0.29156016368859466, 0.28966137870544306, 0.2875035294758747, 0.28509831545479325, 0.28341998261088636, 0.2811936787081466, 0.2796161113505995, 0.27853373191643677, 0.2782309327044093, 0.276636747925103, 0.2746382516222778, 0.27277284675576535, 0.27078584412221535, 0.269158627746264, 0.2677651829413413, 0.26762456534729945, 0.26611578773999106, 0.2649905692608108, 0.26415705728807604, 0.26383652404080526, 0.26298465265688925, 0.26200204312316444, 0.261466875126766, 0.26094804889453066, 0.2600120017346079, 0.2588758463462891, 0.25870860681599694, 0.2582846699434488, 0.2589567838988872, 0.2585021208717381, 0.2577046227068265, 0.25628141042088504, 0.2563630747600946, 0.2564744426790971, 0.25531082490063595, 0.25657403019228775, 0.25644145208322283, 0.25716294991365024, 0.2566142325609113, 0.25601394599877464, 0.25603160533728603, 0.25647128072103026, 0.25580476763534693, 0.25641680803079736, 0.255119834597522, 0.2555565920921689, 0.25502196578614644, 0.2548081960526055, 0.25487950303735846, 0.2541135944382773, 0.25360400719312665, 0.25336073130310627, 0.2525886586863493, 0.2526234178711797, 0.2547469616851054, 0.2543839726609745, 0.25512860971952306, 0.25458916766045836, 0.25470061674772215, 0.25463990735285147, 0.255846604698354, 0.2564842093886024, 0.25657448239991837, 0.2569123917377273, 0.2573832137736332, 0.2581938688152419, 0.25931252904743435, 0.25923952245662046, 0.25893585069611164, 0.2584748849931463, 0.2584275877746735, 0.25837928839976737, 0.259971761379735, 0.2601907520479825, 0.26102391192318797, 0.26074930711926636, 0.2596799114806201, 0.25958216522181743, 0.2589779667488758, 0.26051912302780367, 0.26099575766391947, 0.26154166156471426, 0.26168427492637025, 0.26228143535249165, 0.2634330910139626, 0.26415685951113815, 0.2642197016137849, 0.26527442789357997, 0.26713236922277894, 0.26750524124074476, 0.2682328776148125, 0.2706172858500926, 0.2720228062532349, 0.27360334275561604, 0.2730110239159885, 0.2723750535796723, 0.2719499425855852]
x_ESGD15_s1 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
history_ESGD15_s1 = [0.7147568140029907, 0.6304282743453979, 0.5476327037811279, 0.5232865713119507, 0.466137487411499, 0.4352880061149597, 0.429707958316803, 0.4141815491437912, 0.40402607960700987, 0.39856748695373534, 0.39560625886917117, 0.3848787167549133, 0.3726619354367256, 0.37829248509407043, 0.36344083127975463, 0.35033648595809935, 0.3633711525917053, 0.3492245717048645, 0.3345533056259155, 0.32618020272254944, 0.3271628471374512, 0.3218096014022827, 0.3284188305854797, 0.3124987642765045, 0.3096549178123474, 0.30209641597270964, 0.30357874493598935, 0.3010366109967232, 0.302464484167099, 0.28559590783119204, 0.2829671144485474, 0.2815678305029869, 0.2828524868965149, 0.2782766344666481, 0.2777713876247406, 0.27776736316680906, 0.27520772142410277, 0.2790263852238655, 0.2804336091041565, 0.2751649694442749, 0.26844151775836944, 0.267923314332962, 0.2757044012695551, 0.26917346296310424, 0.27257231385707853, 0.2680828864097595, 0.2634513892650604, 0.2683149870157242, 0.26115694358348845, 0.26541800513267516, 0.26879231700897216, 0.27550573979616166, 0.26228908491134645, 0.2566517848968506, 0.2559842029571533, 0.2529028204202652, 0.2545136803627014, 0.25522417969703676, 0.26635900700092313, 0.2525367892742157, 0.25486360294818877, 0.25665544953346253, 0.26095172481536866, 0.2553178102016449, 0.2531585573196411, 0.25665036315917966, 0.25627861280441283, 0.25158757729530334, 0.24865044785141946, 0.2572034510433674, 0.25446923809051514, 0.26500580949783326, 0.2544101536273956, 0.25052713922262193, 0.24347249984741212, 0.2570980538129807, 0.25747675395011904, 0.24483826489448549, 0.2679428778171539, 0.2552482491016388, 0.2636564303874969, 0.251675776386261, 0.25061136693954467, 0.25619053938388825, 0.2604283591747284, 0.24980614986419677, 0.2619251715898514, 0.24344707369804383, 0.2594874095439911, 0.2502103290319443, 0.252884268450737, 0.255521265900135, 0.24722041704654693, 0.24901772198677063, 0.251171248292923, 0.2456400051355362, 0.2529362505346537, 0.273858856010437, 0.25111707144379614, 0.26183034324646, 0.24973418912887574, 0.2557036585330963, 0.25409352279901504, 0.2667068808078766, 0.2622226516008377, 0.2573869395017624, 0.2599535757780075, 0.2616206120967865, 0.26548976418972015, 0.269380471137166, 0.25858246313929556, 0.25620280485153196, 0.25432619366645814, 0.2580019128084183, 0.2579445940256119, 0.27430401819944383, 0.2621616680622101, 0.2685223508000374, 0.25827786388397217, 0.2500553507328033, 0.25870244889259336, 0.2535401804924011, 0.2743895295381546, 0.2652854693889618, 0.2664547966718674, 0.2629677951812744, 0.26765587918758393, 0.2737979919672012, 0.27067077598571776, 0.2647852805376053, 0.27476696441173554, 0.2838538411855698, 0.2708610894024372, 0.2747816049814224, 0.29207695996761324, 0.2846724898815155, 0.2878281712770462, 0.26768015435934067, 0.2666513205528259, 0.2681239436388016]

# seed 2
ema_ESGD15_s2 = [2.0579672859191893, 2.0579672859191893, 1.953419217634201, 1.8408967722463607, 1.7320140961928367, 1.6309726439824583, 1.5367353848866419, 1.449984209669691, 1.3727095511195617, 1.3007148144791327, 1.2342867606797638, 1.172536178922548, 1.116847792849446, 1.0646304082216365, 1.0191086109430978, 0.9764627905420711, 0.9357790583323464, 0.9009457297543608, 0.8668046537500551, 0.8347389486642418, 0.806381588955975, 0.7786675562944321, 0.7555208585101045, 0.732648239116461, 0.7109476373498955, 0.6908137700067746, 0.6714393284213651, 0.6537451239155628, 0.6372414886468857, 0.6222047814840861, 0.6086021538109888, 0.5954490465412715, 0.5828204789385361, 0.5714379086886492, 0.56045695492935, 0.5504435358331664, 0.5409512728756127, 0.5327643620644918, 0.52508102890446, 0.5192809664803225, 0.5118963685915601, 0.5053363692169546, 0.4986319982998215, 0.4925748267167189, 0.4864377234143059, 0.48109173276204237, 0.47618553380768036, 0.47103618804753306, 0.46672048922187526, 0.46247154481476344, 0.458175254390828, 0.4560911557801296, 0.4519543366451022, 0.44801014186074944, 0.4443482798105235, 0.44129985866121246, 0.43880525718306124, 0.4356883594945784, 0.4324185325153812, 0.43144898453070024, 0.42858340038579673, 0.4262841225277362, 0.42340009519317545, 0.42075823917441485, 0.4185923069744073, 0.41717617457408573, 0.4150453815671701, 0.41278456248994755, 0.4106339664437421, 0.40904054915231897, 0.4073753701793173, 0.40606313412192635, 0.40454792551281904, 0.4023995264466064, 0.4007225542153827, 0.3988446067123931, 0.3971045894458283, 0.3955697438091984, 0.3944250136957423, 0.3935974332808724, 0.39322892753117716, 0.39144590279907077, 0.389987801171393, 0.3880947954568721, 0.38682541203201926, 0.3854711013624172, 0.3843952221717626, 0.38280183943326984, 0.38185534615232686, 0.38050904987556466, 0.3790562164345628, 0.3778457973324578, 0.3784522682169069, 0.3775672149925521, 0.3761982468464158, 0.37500530030413104, 0.37417785310223967, 0.3740154206658179, 0.3726456724796987, 0.37143406070658236, 0.3700055557065189, 0.3686032853531521, 0.36704463789293307, 0.3666576006707174, 0.36601558439522586, 0.3650473800282741, 0.36367137697885016, 0.3629172307546399, 0.36218119324703174, 0.360899134350948, 0.35982239359480067, 0.3602367620324664, 0.3590729252113914, 0.35802590839749715, 0.357149704257424, 0.3572416770694631, 0.3569167500041107, 0.35583406199653567, 0.35515839534556526, 0.3544701437135547, 0.35344121425449937, 0.35332085187941875, 0.3520849401114293, 0.3515701056085147, 0.35124953411836485, 0.35032887101071236, 0.3495675575366362, 0.34874786463773944, 0.34799549769338994, 0.34733034066000906, 0.34649657766734954, 0.3456181119935101, 0.3451643509116518, 0.34436626815737015, 0.34351730799621993, 0.3430396806569098, 0.3422884919987201, 0.3422127952455949, 0.3410355579840664, 0.34036805130370174, 0.3403321081995462]
x_ESGD15_s2 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
history_ESGD15_s2 = [2.0579672859191893, 1.0124866030693054, 0.8281947637557984, 0.7520700117111206, 0.7215995740890503, 0.688600053024292, 0.6692236327171326, 0.677237624168396, 0.652762184715271, 0.6364342764854432, 0.616780943107605, 0.6156523181915283, 0.5946739465713501, 0.6094124354362488, 0.5926504069328308, 0.5696254684448242, 0.5874457725524902, 0.5595349697113037, 0.546147602891922, 0.5511653515815735, 0.5292412623405457, 0.5472005784511567, 0.5267946645736694, 0.5156422214508056, 0.5096089639186859, 0.49706935415267944, 0.4944972833633423, 0.4887087712287903, 0.4868744170188904, 0.4861785047531128, 0.4770710811138153, 0.469163370513916, 0.46899477643966675, 0.46162837109565735, 0.46032276396751404, 0.4555209062576294, 0.4590821647644043, 0.4559310304641724, 0.4670804046630859, 0.4454349875926971, 0.4462963748455048, 0.4382926600456238, 0.4380602824687958, 0.4312037936925888, 0.43297781689167025, 0.4320297432184219, 0.4246920762062073, 0.42787919979095457, 0.4242310451507568, 0.41950864057540893, 0.437334268283844, 0.41472296442985535, 0.4125123888015747, 0.41139152135849, 0.41386406831741335, 0.4163538438796997, 0.407636280298233, 0.4029900897026062, 0.42272305266857146, 0.40279314308166503, 0.40559062180519106, 0.3974438491821289, 0.39698153500556943, 0.3990989171743393, 0.4044309829711914, 0.3958682445049286, 0.39243719079494477, 0.39127860202789305, 0.3946997935295105, 0.3923887594223022, 0.3942530096054077, 0.39091104803085325, 0.38306393485069273, 0.38562980413436887, 0.38194307918548587, 0.3814444340467453, 0.3817561330795288, 0.38412244267463685, 0.38614920954704285, 0.3899123757839203, 0.3753986802101135, 0.3768648865222931, 0.3710577440261841, 0.3754009612083435, 0.37328230533599854, 0.3747123094558716, 0.3684613947868347, 0.37333690662384034, 0.3683923833847046, 0.36598071546554567, 0.3669520254135132, 0.38391050617694855, 0.36960173597335816, 0.36387753353118896, 0.3642687814235687, 0.3667308282852173, 0.37255352873802183, 0.3603179388046265, 0.36052955474853515, 0.3571490107059479, 0.3559828521728516, 0.3530168107509613, 0.3631742656707764, 0.360237437915802, 0.356333540725708, 0.35128734953403473, 0.35612991473674777, 0.3555568556785583, 0.34936060428619387, 0.35013172678947446, 0.3639660779714584, 0.3485983938217163, 0.34860275707244875, 0.34926386699676515, 0.35806943237781524, 0.3539924064159393, 0.34608986992836, 0.34907739548683164, 0.3482758790254593, 0.3441808491230011, 0.35223759050369263, 0.3409617341995239, 0.34693659508228303, 0.34836439070701597, 0.3420429030418396, 0.3427157362699509, 0.3413706285476685, 0.3412241951942444, 0.34134392735958097, 0.3389927107334137, 0.3377119209289551, 0.3410805011749268, 0.33718352336883545, 0.3358766665458679, 0.3387410346031189, 0.3355277940750122, 0.34153152446746826, 0.33044042263031004, 0.33436049118041994, 0.340008620262146]

# seed 3
ema_ESGD15_s3 = [2.196451696395874, 2.196451696395874, 2.1054446193695067, 1.9792569450378417, 1.8616224193763733, 1.7495162704448701, 1.6448584265310289, 1.5495869038461496, 1.460794227884905, 1.3795899284827977, 1.3063074041975977, 1.2387063229918578, 1.1750185405004112, 1.117377470122703, 1.0670316298296405, 1.0182898489019592, 0.9739020983428943, 0.9327377800128926, 0.8946820633252326, 0.8586988748073455, 0.8259447159051785, 0.7961561879944703, 0.7685103845541389, 0.7426388381241004, 0.7196759674571371, 0.6979811084719673, 0.6791775576566614, 0.6602195645071528, 0.6421894296125288, 0.6254940528591617, 0.6110639186322818, 0.5971767882245895, 0.5844234249691472, 0.5725763955253637, 0.561079320939029, 0.5499731006333036, 0.5396113967206004, 0.5304695035981467, 0.5216473745960591, 0.5144380807619033, 0.5072633646447127, 0.5005811528788803, 0.49431226623059493, 0.48811750015021427, 0.4821601743257141, 0.47664422205770873, 0.47075041179613647, 0.4656644411083136, 0.46105670369351576, 0.45663510641471744, 0.45235725657894793, 0.44831384134490415, 0.4466929982393902, 0.4426469895121385, 0.4387524246761438, 0.43521449317597477, 0.43224943697628193, 0.4309123136369301, 0.4291090125424784, 0.42599294493881956, 0.42259776455779163, 0.4196400066013869, 0.41688710926375416, 0.41506737371922997, 0.4132993901858461, 0.41127858168331377, 0.4087011031012022, 0.40691754831495436, 0.40536334324856893, 0.403743055705252, 0.4018726378739083, 0.39981071018042, 0.39779159632618877, 0.39698292368020704, 0.3950885062959739, 0.3937972445774331, 0.39191940631225, 0.38998177260775224, 0.38804250585990124, 0.3865058845253912, 0.38514747371662805, 0.3839185869847758, 0.38267792801335665, 0.38151984232433334, 0.3801541720023843, 0.37876427972356314, 0.3776692311600432, 0.37643739304979906, 0.37515708461678265, 0.3743304316312931, 0.3754028824571546, 0.37442259781155973, 0.37300489941651216, 0.37152130845738585, 0.3699186409791094, 0.3686950243139072, 0.3673983877453629, 0.3668096988827071, 0.3659169902125074, 0.3650988272439605, 0.36384103655676536, 0.3631497778140947, 0.36243545946032807, 0.3616888064433724, 0.3607901319023601, 0.3599000547143786, 0.35852552752014716, 0.3574946772675221, 0.35661627276127084, 0.35627705491946227, 0.35514666285544116, 0.35428865820434224, 0.354103473702668, 0.353161734182476, 0.3525113741983524, 0.3518456878330902, 0.3512756781232294, 0.3504532334684077, 0.3505872473727533, 0.349450686203021, 0.3485027753662272, 0.34746663914125, 0.3465317532289103, 0.3460703981126614, 0.34506908502029787, 0.3443034474275775, 0.34362144308408504, 0.34325152385759716, 0.3429914728283438, 0.34278518679734044, 0.34221796510513997, 0.34160132577445845, 0.3409404035642154, 0.34090243265817227, 0.3405277962630063, 0.3396149588225844, 0.33871851919280554, 0.33832618916797996, 0.3378501129147562, 0.3372715411946612, 0.33669723507095317]
x_ESGD15_s3 = [500, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 6500, 7000, 7500, 8000, 8500, 9000, 9500, 10000, 10500, 11000, 11500, 12000, 12500, 13000, 13500, 14000, 14500, 15000, 15500, 16000, 16500, 17000, 17500, 18000, 18500, 19000, 19500, 20000, 20500, 21000, 21500, 22000, 22500, 23000, 23500, 24000, 24500, 25000, 25500, 26000, 26500, 27000, 27500, 28000, 28500, 29000, 29500, 30000, 30500, 31000, 31500, 32000, 32500, 33000, 33500, 34000, 34500, 35000, 35500, 36000, 36500, 37000, 37500, 38000, 38500, 39000, 39500, 40000, 40500, 41000, 41500, 42000, 42500, 43000, 43500, 44000, 44500, 45000, 45500, 46000, 46500, 47000, 47500, 48000, 48500, 49000, 49500, 50000, 50500, 51000, 51500, 52000, 52500, 53000, 53500, 54000, 54500, 55000, 55500, 56000, 56500, 57000, 57500, 58000, 58500, 59000, 59500, 60000, 60500, 61000, 61500, 62000, 62500, 63000, 63500, 64000, 64500, 65000, 65500, 66000, 66500, 67000, 67500, 68000, 68500, 69000, 69500, 70000]
history_ESGD15_s3 = [2.196451696395874, 1.2863809261322021, 0.8435678760528564, 0.8029116884231567, 0.7405609300613404, 0.7029378313064575, 0.6921431996822357, 0.6616601442337036, 0.6487512338638306, 0.6467646856307984, 0.6302965921401977, 0.6018284980773926, 0.5986078367233276, 0.6139190671920777, 0.579613820552826, 0.5744123433113099, 0.5622589150428772, 0.5521806131362915, 0.5348501781463623, 0.531157285785675, 0.5280594367980957, 0.519698153591156, 0.5097949202537536, 0.5130101314544677, 0.5027273776054383, 0.5099456003189087, 0.4895976261615753, 0.4799182155609131, 0.4752356620788574, 0.48119271059036256, 0.4721926145553589, 0.469643155670166, 0.46595313053131104, 0.45760564966201783, 0.4500171178817749, 0.4463560615062714, 0.44819246549606323, 0.4422482135772705, 0.44955443625450137, 0.44269091958999635, 0.44044124698638915, 0.4378922863960266, 0.43236460542678834, 0.4285442419052124, 0.4270006516456604, 0.4177061194419861, 0.4198907049179077, 0.41958706696033476, 0.41684073090553286, 0.41385660805702207, 0.41192310423851014, 0.4321054102897644, 0.4062329109668732, 0.40370134115219114, 0.4033731096744537, 0.40556393117904666, 0.4188782035827637, 0.41287930269241335, 0.3979483365058899, 0.39204114112854005, 0.3930201849937439, 0.3921110332250595, 0.39868975381851196, 0.39738753838539126, 0.3930913051605225, 0.38550379586219785, 0.39086555523872374, 0.39137549765110013, 0.38916046781539915, 0.3850388773918152, 0.3812533609390259, 0.3796195716381073, 0.38970486986637115, 0.3780387498378754, 0.38217588911056516, 0.37501886192560197, 0.37254306926727293, 0.3705891051292419, 0.372676292514801, 0.3729217764377594, 0.37285860639810564, 0.3715119972705841, 0.3710970711231232, 0.36786313910484314, 0.36625524921417235, 0.3678137940883636, 0.36535085005760193, 0.36363430871963504, 0.3668905547618866, 0.38505493988990785, 0.36560003600120544, 0.360245613861084, 0.3581689898252487, 0.3554946336746216, 0.3576824743270874, 0.35572865862846376, 0.3615114991188049, 0.3578826121807098, 0.3577353605270386, 0.35252092037200927, 0.3569284491300583, 0.3560065942764282, 0.3549689292907715, 0.3527020610332489, 0.35188936002254484, 0.3461547827720642, 0.3482170249938965, 0.3487106322050095, 0.3532240943431854, 0.3449731342792511, 0.3465666163444519, 0.3524368131875992, 0.3446860785007477, 0.34665813434123993, 0.3458545105457306, 0.3461455907344818, 0.3430512315750122, 0.3517933725118637, 0.3392216356754303, 0.339971577835083, 0.33814141311645507, 0.3381177800178528, 0.3419182020664215, 0.3360572671890259, 0.3374127090930939, 0.3374834039926529, 0.33992225081920624, 0.3406510135650635, 0.3409286125183105, 0.3371129698753357, 0.33605157179832457, 0.3349921036720276, 0.3405606945037842, 0.33715606870651244, 0.3313994218587875, 0.3306505625247955, 0.33479521894454956, 0.3335654266357422, 0.33206439571380614, 0.33152847995758056]

### These PDs are all with regularization

## PD 50
ema_PD = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.2549896685770534]
x_PD = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000]
history_PD = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.20081942]

## PD 65
ema_PD65 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24770271883071562]
x_PD65 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600]
history_PD65 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.28116256]

##PD 90
ema_PD90 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24523666307986877, 0.2464710248022774, 0.24757157616402203, 0.24375806021021748, 0.246408487266245, 0.25289448044235335, 0.25585468061150457, 0.2502087260548593, 0.2519723181662847, 0.2510646570984622, 0.24735875778771343, 0.24462183135786864, 0.24305323050653233, 0.24351380723329152, 0.24625706187735585, 0.24734398882255484, 0.24653545463680204, 0.24611626217900792, 0.24936908319716825, 0.24424766154699185, 0.2422968579972922, 0.24296794685528927, 0.23982078748470176, 0.23882868365221288, 0.24057649203336, 0.23968470807250525]
x_PD90 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600]
history_PD90 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.256502, 0.25758028, 0.25747654, 0.20943642, 0.27026233, 0.31126842, 0.28249648, 0.19939514, 0.26784465, 0.24289571, 0.21400566, 0.2199895, 0.22893582, 0.247659, 0.27094635, 0.25712633, 0.23925865, 0.24234353, 0.27864447, 0.19815487, 0.22473963, 0.24900775, 0.21149635, 0.22989975, 0.25630677, 0.23165865]

ema_PD115 = [0.5350429, 0.5350428819656372, 0.5334884405136109, 0.5248474431037903, 0.5088954495191574, 0.4931205833077431, 0.4807713917601109, 0.4708060048557521, 0.46552393935953384, 0.4488681057348979, 0.4306114076902091, 0.41745608383383925, 0.4070136010703436, 0.3986312502673559, 0.39135356432658075, 0.38401919024999415, 0.3737821646137429, 0.36554510899812515, 0.35732613064435603, 0.34912193171013134, 0.34501218812312545, 0.3411861331759023, 0.3356953118590827, 0.33409125396743256, 0.3282917480689422, 0.32394734987814444, 0.3198931840288569, 0.3150535965467629, 0.31054607133613266, 0.31234867662679766, 0.3104503001912679, 0.30816842730142885, 0.30422361447183677, 0.299455950442866, 0.30066174249403077, 0.29788356107967257, 0.2998127318843945, 0.29406470454556444, 0.2939940398647431, 0.2904959594351688, 0.28449526951992266, 0.2793391289676763, 0.27594864896227755, 0.27995423255523894, 0.28241053323293497, 0.27717322051833365, 0.2757088447240915, 0.2692649413312608, 0.26303551189587715, 0.2610085853262502, 0.25758154824290497, 0.2539770808957263, 0.255530691785417, 0.25712801215899167, 0.2529643985437051, 0.25172596539318826, 0.2541830214732313, 0.25834370012939784, 0.2583099546062423, 0.258226383509708, 0.25345056097132496, 0.2507063970603573, 0.24973158320528516, 0.2489560778207384, 0.24398495870233797, 0.24523666307986877, 0.2464710248022774, 0.24757157616402203, 0.24375806021021748, 0.246408487266245, 0.25289448044235335, 0.25585468061150457, 0.2502087260548593, 0.2519723181662847, 0.2510646570984622, 0.24735875778771343, 0.24462183135786864, 0.24305323050653233, 0.24351380723329152, 0.24625706187735585, 0.24734398882255484, 0.24653545463680204, 0.24611626217900792, 0.24936908319716825, 0.24424766154699185, 0.2422968579972922, 0.24296794685528927, 0.23982078748470176, 0.23882868365221288, 0.24057649203336, 0.24338062669213797, 0.24159170745649505, 0.2452235599652401, 0.24435601356287046, 0.2494132344960503, 0.24803203419202555, 0.24772840954679837, 0.2456880559130185, 0.24486578401359976, 0.24372205790668483, 0.248238012106327, 0.2511196418801914, 0.2562253073632691, 0.25025442353904015, 0.24999537121075185, 0.2497164835108917, 0.2534648564076663, 0.25757465838935145, 0.2532048768956617, 0.24950225029818612, 0.24842513985424397, 0.24610928345014893, 0.24025482071897605, 0.23873455792779819, 0.24079073789818672, 0.24363810112866988]
x_PD115 = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
history_PD115 = [0.5350429, 0.51949847, 0.44707847, 0.3653275, 0.3511468, 0.36962867, 0.38111752, 0.41798535, 0.2989656, 0.26630113, 0.29905817, 0.31303126, 0.3231901, 0.3258544, 0.31800982, 0.28164893, 0.2914116, 0.28335533, 0.27528414, 0.3080245, 0.30675164, 0.28627792, 0.31965473, 0.2760962, 0.28484777, 0.2834057, 0.2714973, 0.26997834, 0.32857212, 0.2933649, 0.28763157, 0.2687203, 0.25654697, 0.31151387, 0.27287993, 0.31717527, 0.24233246, 0.29335806, 0.25901324, 0.23048906, 0.23293386, 0.24543433, 0.31600448, 0.30451724, 0.2300374, 0.26252946, 0.21126981, 0.20697065, 0.24276625, 0.22673821, 0.22153687, 0.2695132, 0.2715039, 0.21549188, 0.24058007, 0.27629653, 0.2957898, 0.25800624, 0.25747424, 0.21046816, 0.22600892, 0.24095826, 0.24197653, 0.19924489, 0.256502, 0.25758028, 0.25747654, 0.20943642, 0.27026233, 0.31126842, 0.28249648, 0.19939514, 0.26784465, 0.24289571, 0.21400566, 0.2199895, 0.22893582, 0.247659, 0.27094635, 0.25712633, 0.23925865, 0.24234353, 0.27864447, 0.19815487, 0.22473963, 0.24900775, 0.21149635, 0.22989975, 0.25630677, 0.26861784, 0.22549143, 0.27791023, 0.2365481, 0.29492822, 0.23560123, 0.24499579, 0.22732487, 0.23746534, 0.23342852, 0.2888816, 0.2770543, 0.3021763, 0.19651647, 0.2476639, 0.2472065, 0.2872002, 0.29456288, 0.21387684, 0.21617861, 0.23873115, 0.22526658, 0.18756466, 0.2250522, 0.25929636, 0.26926437]



## PD 115 without Reg
# seed 74
ema_PD115_nr = [0.53825915, 0.5382591485977173, 0.5335141867399216, 0.5244838669896126, 0.508424261957407, 0.49281837619841096, 0.4797417111173272, 0.4696703362740577, 0.4636418707618863, 0.447998117278494, 0.43114286440951605, 0.42039907972523255, 0.4115504443690957, 0.40273636162690357, 0.3958662502206448, 0.38804983069632204, 0.37944798144817726, 0.369781239090446, 0.3597665607256443, 0.3520985674252585, 0.3466159699610301, 0.340463805042335, 0.33351753161188535, 0.3312950760647944, 0.3245880660884343, 0.31899329639727736, 0.31286365345646316, 0.3071719427901152, 0.3003992769120017, 0.3014283656774055, 0.30230561313314064, 0.30091641918375633, 0.29740216054518115, 0.29292793915866994, 0.2896727458792852, 0.285264773919397, 0.287017247457099, 0.28106967781078107, 0.28222847140513024, 0.27976502618207477, 0.2769962338299806, 0.2739082459531357, 0.26879439359207125, 0.27113963608711217, 0.2722828606793516, 0.27045282602571546, 0.2703919698023477, 0.2673431133529853, 0.26237769829940594, 0.26211472369174776, 0.25968666389829476, 0.2591705636553159, 0.2611346110438279, 0.2603800265254055, 0.2585913436050541, 0.2574413937123412, 0.2590286125354583, 0.26347287502401606, 0.265622621832909, 0.2646594220923977, 0.2593733228320715, 0.25601721320225335, 0.2579109327227491, 0.25813859011804624, 0.25268320118852466, 0.2565968502354742, 0.2579259576313604, 0.2577415646832802, 0.2534503765453355, 0.2556136751964202, 0.26259872360180414, 0.26430178621247946, 0.25914152507932964, 0.2627502505029915, 0.2617949209254097, 0.25616590633759895, 0.254591700030297, 0.2534724249776572, 0.2519329375925395, 0.25412112059319614, 0.2546068601202184, 0.2543689256064189, 0.25654250191021793, 0.26167801445456296, 0.2590089612519617, 0.2582155412419923, 0.26132174247362805, 0.2556130833672755, 0.25582638209288777, 0.2569670393338096, 0.2579240990522765, 0.25445823307424154, 0.2607423642479423, 0.26317994706657916, 0.2678893617942398, 0.26643724550197706, 0.26818498351624775, 0.2681307617883489, 0.2660552538091486, 0.26531653195511207, 0.2695292018940232, 0.27127007392855124, 0.2747816987140027, 0.2692325217100722, 0.26915851556415044, 0.268311285881591, 0.27148792497073904, 0.27370123879690733, 0.26591533407491236, 0.2644295720898073, 0.26360142189052355, 0.2618113782207964, 0.25700060661442264, 0.2566419047338413, 0.2579934062560779, 0.2611111338734969]
x_PD115_nr = [640, 1280, 1920, 2560, 3200, 3840, 4480, 5120, 5760, 6400, 7040, 7680, 8320, 8960, 9600, 10240, 10880, 11520, 12160, 12800, 13440, 14080, 14720, 15360, 16000, 16640, 17280, 17920, 18560, 19200, 19840, 20480, 21120, 21760, 22400, 23040, 23680, 24320, 24960, 25600, 26240, 26880, 27520, 28160, 28800, 29440, 30080, 30720, 31360, 32000, 32640, 33280, 33920, 34560, 35200, 35840, 36480, 37120, 37760, 38400, 39040, 39680, 40320, 40960, 41600, 42240, 42880, 43520, 44160, 44800, 45440, 46080, 46720, 47360, 48000, 48640, 49280, 49920, 50560, 51200, 51840, 52480, 53120, 53760, 54400, 55040, 55680, 56320, 56960, 57600, 58240, 58880, 59520, 60160, 60800, 61440, 62080, 62720, 63360, 64000, 64640, 65280, 65920, 66560, 67200, 67840, 68480, 69120, 69760, 70400, 71040, 71680, 72320, 72960, 73600]
history_PD115_nr = [0.53825915, 0.49080953, 0.443211, 0.36388782, 0.3523654, 0.36205173, 0.37902796, 0.40938568, 0.30720434, 0.2794456, 0.32370502, 0.33191273, 0.32340962, 0.33403525, 0.31770205, 0.30203134, 0.28278056, 0.26963446, 0.28308663, 0.2972726, 0.28509432, 0.27100107, 0.31129298, 0.26422498, 0.26864037, 0.25769687, 0.25594655, 0.23944528, 0.31069016, 0.31020084, 0.28841367, 0.26577383, 0.25265995, 0.260376, 0.24559303, 0.3027895, 0.22754155, 0.2926576, 0.25759402, 0.2520771, 0.24611636, 0.22276972, 0.29224682, 0.28257188, 0.2539825, 0.26984426, 0.2399034, 0.21768896, 0.25974795, 0.23783413, 0.25452566, 0.27881104, 0.25358877, 0.2424932, 0.24709184, 0.27331358, 0.30347124, 0.28497034, 0.25599062, 0.21179843, 0.22581223, 0.2749544, 0.2601875, 0.2035847, 0.2918197, 0.26988792, 0.25608203, 0.21482968, 0.27508336, 0.32546416, 0.27962935, 0.21269917, 0.29522878, 0.25319695, 0.20550478, 0.24042384, 0.24339895, 0.23807755, 0.27381477, 0.25897852, 0.25222751, 0.2761047, 0.30789763, 0.23498748, 0.25107476, 0.28927755, 0.20423515, 0.25774607, 0.26723295, 0.26653764, 0.22326544, 0.31729954, 0.2851182, 0.3102741, 0.2533682, 0.28391463, 0.26764277, 0.24737568, 0.25866804, 0.30744323, 0.28693792, 0.30638632, 0.21928993, 0.26849246, 0.26068622, 0.30007768, 0.29362106, 0.19584219, 0.2510577, 0.25614807, 0.24570099, 0.21370366, 0.2534136, 0.27015692, 0.28917068]


## Grid Search with Reg
ema_GS_reg = [0.5646509, 0.5646508932113647, 0.5579137057065964, 0.5419458642601966, 0.5295922215282917, 0.514656521871686, 0.5008631032660603, 0.4896589739878475, 0.4752416780972033, 0.460153913919647, 0.44705350377367686, 0.43913057307785824, 0.4348314123784251, 0.430309487947948, 0.42392752489667584, 0.4132362477888595, 0.41101954933195683, 0.4025619347946886, 0.3965393948605994, 0.39183915985089596, 0.38538722693141153, 0.3871319070388304, 0.37719305827582716, 0.3740695489141182, 0.3748653059625181, 0.37619058717103776, 0.37536566938887816, 0.36802879708347425, 0.36399144891504387, 0.3619825777137632, 0.35801140398302866, 0.3579028898225951, 0.35734103504539083, 0.3543623034690668, 0.3595311413289472, 0.3608973446561126, 0.3600635012751724, 0.36042285091572157, 0.3583863359113916, 0.355823577769433, 0.35119965195164193, 0.35097636448894537, 0.34770003557999074, 0.3436643266749305, 0.33996383703398014, 0.33454473933560225, 0.3332426856844059, 0.33084995247916266, 0.3332663479268183, 0.33418374980863597]
x_GS_reg = [3200, 6400, 9600, 12800, 16000, 19200, 22400, 25600, 28800, 32000, 35200, 38400, 41600, 44800, 48000, 51200, 54400, 57600, 60800, 64000, 67200, 70400, 73600, 76800, 80000, 83200, 86400, 89600, 92800, 96000, 99200, 102400, 105600, 108800, 112000, 115200, 118400, 121600, 124800, 128000, 131200, 134400, 137600, 140800, 144000, 147200, 150400, 153600, 156800]
history_GS_reg = [0.5646509, 0.49727902, 0.3982353, 0.41840944, 0.38023522, 0.37672234, 0.3888218, 0.34548602, 0.32436404, 0.3291498, 0.3678242, 0.39613897, 0.38961217, 0.36648986, 0.31701475, 0.39106926, 0.3264434, 0.34233654, 0.34953704, 0.32731983, 0.40283403, 0.28774342, 0.34595796, 0.38202712, 0.38811812, 0.3679414, 0.30199695, 0.32765532, 0.34390274, 0.32227084, 0.35692626, 0.35228434, 0.32755372, 0.40605068, 0.37319317, 0.3525589, 0.363657, 0.3400577, 0.33275875, 0.30958432, 0.34896678, 0.31821308, 0.30734295, 0.30665943, 0.28577286, 0.3215242, 0.30931535, 0.3550139, 0.34244037]

ema_GS = [0.60191965, 0.6019196510314941, 0.5915467321872712, 0.5712674301862717, 0.5589803047776222, 0.5436787326157093, 0.5288852857667208, 0.5174447304413915, 0.5004676675563634, 0.48620679042627635, 0.47264857347509465, 0.4642135404560077, 0.4610054585051335, 0.4530209832827864, 0.4479056060410098, 0.4366634631243249, 0.4339177051860303, 0.4281948482702562, 0.42155918559822936, 0.41697893215471654, 0.411047941505201, 0.4157004738384074, 0.408908163118385, 0.4075549941730703, 0.40713736428071906, 0.40840760481282934, 0.41258012007407724, 0.4086886800891076, 0.40386966981583067, 0.40284506784164814, 0.397644525524532, 0.3997034839599328, 0.3979798208304343, 0.39570748066557326, 0.3979234092442949, 0.39860503909070133, 0.399350673291792, 0.4020585063103225, 0.3990703144374537, 0.40103644299832414, 0.39665767700964893, 0.39764911667848846, 0.39825933339904446, 0.393530674243367, 0.3981739319542613, 0.3947912517648548, 0.3966713097806224, 0.39366299037177405, 0.3988130699757252, 0.4022170464244646]
x_GS = [3200, 6400, 9600, 12800, 16000, 19200, 22400, 25600, 28800, 32000, 35200, 38400, 41600, 44800, 48000, 51200, 54400, 57600, 60800, 64000, 67200, 70400, 73600, 76800, 80000, 83200, 86400, 89600, 92800, 96000, 99200, 102400, 105600, 108800, 112000, 115200, 118400, 121600, 124800, 128000, 131200, 134400, 137600, 140800, 144000, 147200, 150400, 153600, 156800]
x_GS = [i / 5 for i in x_GS]
history_GS = [0.60191965, 0.49819046, 0.3887537, 0.44839618, 0.40596458, 0.39574426, 0.41447973, 0.3476741, 0.3578589, 0.35062462, 0.38829824, 0.43213272, 0.3811607, 0.4018672, 0.33548418, 0.40920588, 0.37668914, 0.36183822, 0.37575665, 0.35766903, 0.45757326, 0.34777737, 0.39537647, 0.4033787, 0.41983977, 0.45013276, 0.37366572, 0.36049858, 0.39362365, 0.35083964, 0.4182341, 0.38246685, 0.37525642, 0.41786677, 0.4047397, 0.40606138, 0.426429, 0.3721766, 0.4187316, 0.35724878, 0.40657207, 0.40375128, 0.35097274, 0.43996325, 0.36434713, 0.41359183, 0.36658812, 0.4451638, 0.43285283]


## KT RandomSearch
ema_KT_s1 = [0.75, 0.75, 0.3428066670894623, 0.3308306336402893, 0.5133]
x_KT _s1 = [0, 47736, 47736, 48672, 48672 + 936]

ema_KT_s2 = [0.8, 0.8, 0.3382488489151001, 0.30403029918670654, 0.31463396549224854, 0.31585460901260376]
x_KT _s2 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936]

ema_KT_s3 = [0.7, 0.7, 0.3934713900089264, 0.32653290033340454, 0.3017231822013855, 0.3618181645870209, 0.44951480627059937]
x_KT _s3 = [0, 47736, 47736, 48672, 48672 + 936, 48672 + 936 + 936, 48672 + 936 + 936 + 936]



# function to plot with standard deviations
def plot_with_std(ax, x, y, y_std, **kwargs):
    line, = ax.plot(x, y, **kwargs)
    alpha = 1
    ax.fill_between(x, y-y_std, y+y_std, color=line.get_color(), alpha=alpha*0.5)
    between, = ax.fill(np.NaN, np.NaN, color=line.get_color(), alpha=alpha*0.5)
    return (between, line)



x = x_PD115_nr
y = ema_PD115_nr[:len(history_PD115_nr)
y_std = np.std(y)
sklf;j




fig, ax = plt.subplots()

# plotting with std
plot_with_std(ax, x, y, y_std)



# ax.plot(x_ESGD15, ema_ESGD15[:len(history_ESGD15)], ls=':', label = "ESGD")
# ax.plot(x_PD115_nr, ema_PD115_nr[:len(history_PD115_nr)], label = "Population Descent")
# # ax.plot(x_PD, ema_PD[:len(history_PD)], label = "Population Descent")
# ax.plot(x_GS, ema_GS[:len(history_GS)], ls='--', label = "Grid Search")
# ax.plot(x_KT, ema_KT, ls='-.', label = "KT RandomSearch")

# # labels
# plt.title("FMNIST Val Loss Progress")
# plt.xlabel("Gradient Steps")
# plt.ylabel("Validation Loss")
# plt.tight_layout()

# # legend
# leg = ax.legend();

plt.show()





# def graph_history(history):
# 	integers = [i for i in range(1, (len(history))+1)]

# 	ema = []
# 	avg = history[0]

# 	ema.append(avg)

# 	for loss in history:
# 		avg = (avg * 0.9) + (0.1 * loss)
# 		ema.append(avg)


# 	x = [j * 938 for j in integers]
# 	y = history

# 	# plot line
# 	plt.plot(x, ema[:len(history)])
# 	# plot title/captions
# 	plt.title("FMNIST Val Loss")
# 	plt.xlabel("Gradient Steps")
# 	plt.ylabel("Validation Loss")
# 	plt.tight_layout()


# 	print("ema:"), print(ema), print("")
# 	print("x:"), print(x), print("")
# 	print("history:"), print(history), print("")


	
# 	# plt.savefig("TEST_DATA/PD_trial_%s.png" % trial)
# 	def save_image(filename):
# 	    p = PdfPages(filename)
# 	    fig = plt.figure(1)
# 	    fig.savefig(p, format='pdf') 
# 	    p.close()

# 	filename = "FMNIST_progress_with_reg_model4_line.pdf"
# 	save_image(filename)

# 	# plot points too
# 	plt.scatter(x, history, s=20)

# 	def save_image(filename):
# 	    p = PdfPages(filename)
# 	    fig = plt.figure(1)
# 	    fig.savefig(p, format='pdf') 
# 	    p.close()

# 	filename = "FMNIST_progress_with_reg_model4_with_points.pdf"
# 	save_image(filename)


# 	plt.show(block=True), plt.close()
# 	plt.close('all')



